From e25a9ae69524ce89090c1c90b4a65be7ef136d3e Mon Sep 17 00:00:00 2001
From: Silvio Traversaro <silvio@traversaro.it>
Date: Sun, 18 Jan 2026 13:51:20 +0100
Subject: [PATCH] Replace boost::asio::io_service with boost::asio::io_context
 for boost 1.88 compatibility

---
 applications/lds_driver/lds_driver.cpp                       | 4 ++--
 applications/lds_driver/lds_driver.h                         | 2 +-
 applications/lds_polar_graph/lds_polar_graph.h               | 2 +-
 include/hls_lfcd_lds_driver/hlds_laser_segment_publisher.hpp | 2 +-
 include/hls_lfcd_lds_driver/lfcd_laser.hpp                   | 2 +-
 src/hlds_laser_publisher.cpp                                 | 4 ++--
 src/hlds_laser_segment_publisher.cpp                         | 4 ++--
 7 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/applications/lds_driver/lds_driver.cpp b/applications/lds_driver/lds_driver.cpp
index 4e46529..2504e09 100644
--- a/applications/lds_driver/lds_driver.cpp
+++ b/applications/lds_driver/lds_driver.cpp
@@ -36,7 +36,7 @@
 
 namespace lds
 {
-LFCDLaser::LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_service& io)
+LFCDLaser::LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_context& io)
   : port_(port), baud_rate_(baud_rate), shutting_down_(false), serial_(io, port_)
 {
   serial_.set_option(boost::asio::serial_port_base::baud_rate(baud_rate_));
@@ -143,7 +143,7 @@ int main(int argc, char **argv)
   uint16_t rpms;
   port = "/dev/ttyUSB0";
   baud_rate = 230400;
-  boost::asio::io_service io;
+  boost::asio::io_context io;
 
   try
   {
diff --git a/applications/lds_driver/lds_driver.h b/applications/lds_driver/lds_driver.h
index 971dc82..005a7d8 100644
--- a/applications/lds_driver/lds_driver.h
+++ b/applications/lds_driver/lds_driver.h
@@ -48,7 +48,7 @@ public:
 	* @param baud_rate The baud rate to open the serial port at.
 	* @param io Boost ASIO IO Service to use when creating the serial port object
 	*/
-	LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_service& io);
+	LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_context& io);
 
 	/**
 	* @brief Default destructor
diff --git a/applications/lds_polar_graph/lds_polar_graph.h b/applications/lds_polar_graph/lds_polar_graph.h
index 38a5203..0f481dd 100644
--- a/applications/lds_polar_graph/lds_polar_graph.h
+++ b/applications/lds_polar_graph/lds_polar_graph.h
@@ -65,7 +65,7 @@ private:
   qreal angular_max_;
   qreal radial_min_;
   qreal radial_max;
-  boost::asio::io_service io_;
+  boost::asio::io_context io_;
   std::string port_; ///< @brief The serial port the driver is attached to
   uint32_t baud_rate_; ///< @brief The baud rate for the serial connection
   bool shutting_down_; ///< @brief Flag for whether the driver is supposed to be shutting down or not
diff --git a/include/hls_lfcd_lds_driver/hlds_laser_segment_publisher.h b/include/hls_lfcd_lds_driver/hlds_laser_segment_publisher.h
index 746d91a..a8d8909 100644
--- a/include/hls_lfcd_lds_driver/hlds_laser_segment_publisher.h
+++ b/include/hls_lfcd_lds_driver/hlds_laser_segment_publisher.h
@@ -53,7 +53,7 @@ class LFCDLaser
   * @param baud_rate The baud rate to open the serial port at.
   * @param io Boost ASIO IO Service to use when creating the serial port object
   */
-	LFCDLaser(boost::asio::io_service& io);
+	LFCDLaser(boost::asio::io_context& io);
 
   /**
   * @brief Default destructor
diff --git a/include/hls_lfcd_lds_driver/lfcd_laser.hpp b/include/hls_lfcd_lds_driver/lfcd_laser.hpp
index b09f9ec..b985219 100644
--- a/include/hls_lfcd_lds_driver/lfcd_laser.hpp
+++ b/include/hls_lfcd_lds_driver/lfcd_laser.hpp
@@ -49,7 +49,7 @@ public:
 	* @param baud_rate The baud rate to open the serial port at.
 	* @param io Boost ASIO IO Service to use when creating the serial port object
 	*/
-	LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_service& io);
+	LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_context& io);
 
 	/**
 	* @brief Default destructor
diff --git a/src/hlds_laser_publisher.cpp b/src/hlds_laser_publisher.cpp
index cfebeba..d45465f 100644
--- a/src/hlds_laser_publisher.cpp
+++ b/src/hlds_laser_publisher.cpp
@@ -39,7 +39,7 @@
 
 namespace hls_lfcd_lds
 {
-LFCDLaser::LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_service& io)
+LFCDLaser::LFCDLaser(const std::string& port, uint32_t baud_rate, boost::asio::io_context& io)
   : port_(port), baud_rate_(baud_rate), shutting_down_(false), serial_(io, port_)
 {
   serial_.set_option(boost::asio::serial_port_base::baud_rate(baud_rate_));
@@ -139,7 +139,7 @@ int main(int argc, char **argv)
 
   auto node = rclcpp::Node::make_shared("hlds_laser_publisher");
   rclcpp::Publisher<sensor_msgs::msg::LaserScan>::SharedPtr laser_pub;
-  boost::asio::io_service io;
+  boost::asio::io_context io;
 
   std::string port;
   std::string frame_id;
diff --git a/src/hlds_laser_segment_publisher.cpp b/src/hlds_laser_segment_publisher.cpp
index 9185961..eedc6f7 100644
--- a/src/hlds_laser_segment_publisher.cpp
+++ b/src/hlds_laser_segment_publisher.cpp
@@ -39,7 +39,7 @@
 
 namespace hls_lfcd_lds
 {
-LFCDLaser::LFCDLaser(boost::asio::io_service& io)
+LFCDLaser::LFCDLaser(boost::asio::io_context& io)
 : serial_(io),
   shutting_down_(false)
 {
@@ -137,7 +137,7 @@ int main(int argc, char* argv[])
 {
   ros::init(argc, argv, "hlds_laser_segment_publisher");
 
-  boost::asio::io_service io;
+  boost::asio::io_context io;
   hls_lfcd_lds::LFCDLaser laser(io);
 
   while (ros::ok())
